"use strict";(self.webpackChunkcap_webview=self.webpackChunkcap_webview||[]).push([[298],{8298:($t,h,s)=>{s.r(h),s.d(h,{TasksListComponent:()=>p,TasksModule:()=>Kt,TasksRoutingModule:()=>D});var w=s(7582),N=s(6328),A=s(7398),d=s(3566),M=s(298),x=s(3365),r=s(5313),_=s(6825),C=s(7848),k=s(2300),t=s(5879),y=s(7917),v=s(2099),b=s(1705),Q=s(9653),J=s(3969),m=s(6814),u=s(6223),L=s(3680),S=s(2296),T=s(9157),I=s(617),E=s(2032),q=s(8525),f=s(4104);function U(e,a){1&e&&(t.TgZ(0,"mat-icon",19),t._uU(1,"checklist"),t.qZA(),t._uU(2," Open "))}function Y(e,a){1&e&&(t.TgZ(0,"mat-icon",19),t._uU(1,"done"),t.qZA(),t._uU(2," Done "))}function K(e,a){1&e&&(t.TgZ(0,"mat-icon",19),t._uU(1,"check_circle"),t.qZA(),t._uU(2," Verified "))}function $(e,a){1&e&&(t.TgZ(0,"mat-tab"),t.YNc(1,K,3,0,"ng-template",2),t.qZA())}function F(e,a){if(1&e){const n=t.EpF();t.TgZ(0,"button",20),t.NdJ("click",function(){t.CHM(n);const o=t.oxw();return t.KtG(o.createRecord())}),t.TgZ(1,"mat-icon"),t._uU(2,"add"),t.qZA(),t._uU(3),t.qZA()}if(2&e){const n=t.oxw();t.xp6(3),t.Oqu(n.TKey.COMMON.ADD)}}function R(e,a){1&e&&t.GkF(0)}function B(e,a){1&e&&t.GkF(0)}function G(e,a){1&e&&t.GkF(0)}function H(e,a){if(1&e&&(t.ynx(0),t._uU(1),t.BQk()),2&e){const n=t.oxw(3);t.xp6(1),t.Oqu(n.TKey.COMMON.DURATION)}}function P(e,a){if(1&e&&(t.ynx(0),t._uU(1),t.BQk()),2&e){const n=t.oxw(2).$implicit;t.xp6(1),t.Oqu(n)}}function V(e,a){if(1&e&&(t.TgZ(0,"mat-header-cell",24),t.ynx(1,25),t.YNc(2,R,1,0,"ng-container",26),t.YNc(3,B,1,0,"ng-container",26),t.YNc(4,G,1,0,"ng-container",26),t.YNc(5,H,2,1,"ng-container",26),t.YNc(6,P,2,1,"ng-container",27),t.BQk(),t.qZA()),2&e){const n=t.oxw().$implicit,i=t.oxw();t.Q6J("ngClass","de-f-justifycenter"),t.xp6(1),t.Q6J("ngSwitch",n),t.xp6(1),t.Q6J("ngSwitchCase","ACTIONS"),t.xp6(1),t.Q6J("ngSwitchCase","Priority"),t.xp6(1),t.Q6J("ngSwitchCase","Type"),t.xp6(1),t.Q6J("ngSwitchCase",i.durationColName)}}const z=function(e,a,n){return{"danger-text":e,"primary-text":a,"warning-text":n}};function j(e,a){if(1&e&&(t.ynx(0),t.TgZ(1,"mat-icon",28),t._uU(2,"stars"),t.qZA(),t.BQk()),2&e){const n=t.oxw().$implicit,i=t.oxw().$implicit;t.xp6(1),t.Q6J("ngClass",t.kEZ(1,z,"High"===n[i],"Medium"===n[i],"Low"===n[i]))}}function W(e,a){1&e&&(t.ynx(0),t.TgZ(1,"mat-icon",29),t._uU(2,"wifi"),t.qZA(),t.BQk())}function X(e,a){1&e&&(t.ynx(0),t.TgZ(1,"mat-icon",30),t._uU(2,"wifi"),t.qZA(),t.BQk())}function tt(e,a){1&e&&(t.ynx(0),t.TgZ(1,"mat-icon",29),t._uU(2,"cable"),t.qZA(),t.BQk())}function et(e,a){1&e&&(t.ynx(0),t.TgZ(1,"mat-icon",30),t._uU(2,"cable"),t.qZA(),t.BQk())}function nt(e,a){1&e&&(t.ynx(0),t.TgZ(1,"mat-icon",31),t._uU(2,"task"),t.qZA(),t.BQk())}function it(e,a){if(1&e&&(t.ynx(0)(1,25),t.YNc(2,W,3,0,"ng-container",26),t.YNc(3,X,3,0,"ng-container",26),t.YNc(4,tt,3,0,"ng-container",26),t.YNc(5,et,3,0,"ng-container",26),t.YNc(6,nt,3,0,"ng-container",27),t.BQk()()),2&e){const n=t.oxw().$implicit,i=t.oxw().$implicit;t.xp6(1),t.Q6J("ngSwitch",n[i]),t.xp6(1),t.Q6J("ngSwitchCase","Internet Lead"),t.xp6(1),t.Q6J("ngSwitchCase","Internet Fault"),t.xp6(1),t.Q6J("ngSwitchCase","Cable Lead"),t.xp6(1),t.Q6J("ngSwitchCase","Cable Fault")}}function at(e,a){if(1&e&&(t.ynx(0),t._uU(1),t.BQk()),2&e){const n=t.oxw().$implicit;t.xp6(1),t.Oqu(n.DurationInHumanizeFormat)}}function ot(e,a){if(1&e&&(t.ynx(0),t._uU(1),t.BQk()),2&e){const n=t.oxw().$implicit;t.xp6(1),t.Oqu(n.OpenDateStr)}}function st(e,a){if(1&e&&(t.ynx(0),t._uU(1),t.BQk()),2&e){const n=t.oxw().$implicit;t.xp6(1),t.Oqu(n.DoneDateStr)}}function ct(e,a){if(1&e&&(t.TgZ(0,"div",33),t._UZ(1,"de-copyable-text",34),t.TgZ(2,"div",35),t._UZ(3,"de-mobile-number",36)(4,"de-mobile-number",37),t.qZA()()),2&e){const n=t.oxw(2).$implicit,i=t.oxw().$implicit;t.xp6(1),t.Q6J("text",n[i]),t.xp6(2),t.Q6J("mobile",n[i]),t.xp6(1),t.Q6J("mobile",n[i])}}function lt(e,a){if(1&e&&(t.ynx(0),t.YNc(1,ct,5,3,"div",32),t.BQk()),2&e){const n=t.oxw().$implicit,i=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",n[i])}}function rt(e,a){if(1&e){const n=t.EpF();t.TgZ(0,"mat-icon",40),t.NdJ("click",function(){t.CHM(n);const o=t.oxw(3).$implicit,c=t.oxw(2);return t.KtG(c.recordToDelete=o)}),t._uU(1,"delete"),t.qZA()}}function _t(e,a){if(1&e){const n=t.EpF();t.ynx(0),t.TgZ(1,"mat-icon",38),t.NdJ("click",function(){t.CHM(n);const o=t.oxw(2).$implicit,c=t.oxw(2);return t.KtG(c.editRecord(o))}),t._uU(2,"edit"),t.qZA(),t.YNc(3,rt,2,0,"mat-icon",39),t.BQk()}if(2&e){const n=t.oxw(4);t.xp6(3),t.Q6J("ngIf",n.authService.isTasksAdmin())}}function mt(e,a){if(1&e&&(t.ynx(0),t.YNc(1,_t,4,1,"ng-container",3),t.BQk()),2&e){const n=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",null==n?null:n.ID)}}function pt(e,a){if(1&e&&(t.ynx(0),t._uU(1),t.BQk()),2&e){const n=t.oxw().$implicit,i=t.oxw().$implicit;t.xp6(1),t.Oqu(n[i])}}function gt(e,a){if(1&e&&(t.TgZ(0,"mat-cell",28),t.ynx(1,25),t.YNc(2,j,3,5,"ng-container",26),t.YNc(3,it,7,5,"ng-container",26),t.YNc(4,at,2,1,"ng-container",26),t.YNc(5,ot,2,1,"ng-container",26),t.YNc(6,st,2,1,"ng-container",26),t.YNc(7,lt,2,1,"ng-container",26),t.YNc(8,mt,2,1,"ng-container",26),t.YNc(9,pt,2,1,"ng-container",27),t.BQk(),t.qZA()),2&e){const n=a.$implicit,i=t.oxw().$implicit,o=t.oxw();t.Q6J("ngClass",o.getCellClassNames(n,i)),t.xp6(1),t.Q6J("ngSwitch",i),t.xp6(1),t.Q6J("ngSwitchCase","Priority"),t.xp6(1),t.Q6J("ngSwitchCase","Type"),t.xp6(1),t.Q6J("ngSwitchCase",o.durationColName),t.xp6(1),t.Q6J("ngSwitchCase","OpenDate"),t.xp6(1),t.Q6J("ngSwitchCase","DoneDate"),t.xp6(1),t.Q6J("ngSwitchCase","MOBILE"),t.xp6(1),t.Q6J("ngSwitchCase","ACTIONS")}}function dt(e,a){1&e&&(t.ynx(0,21),t.YNc(1,V,7,6,"mat-header-cell",22),t.YNc(2,gt,10,9,"mat-cell",23),t.BQk()),2&e&&t.s9C("matColumnDef",a.$implicit)}function ut(e,a){1&e&&t.GkF(0)}const O=function(e){return{$implicit:e}};function Tt(e,a){if(1&e&&(t.TgZ(0,"div",43),t.YNc(1,ut,1,0,"ng-container",44),t.qZA()),2&e){const n=t.oxw().$implicit;t.oxw();const i=t.MAs(19);t.xp6(1),t.Q6J("ngTemplateOutlet",i)("ngTemplateOutletContext",t.VKq(2,O,n))}}function ft(e,a){if(1&e&&(t.TgZ(0,"mat-cell",41),t.YNc(1,Tt,2,4,"div",42),t.qZA()),2&e){const n=a.$implicit,i=t.oxw();t.Q6J("ngClass",n!==i.expandedElement?"de-noborder--force":""),t.uIk("colspan",10),t.xp6(1),t.Q6J("ngIf",n===i.expandedElement)}}function ht(e,a){1&e&&t._UZ(0,"mat-header-row")}const xt=function(e){return{"highlight-row":e}};function Ct(e,a){if(1&e){const n=t.EpF();t.TgZ(0,"mat-row",45),t.NdJ("click",function(){const c=t.CHM(n).$implicit,l=t.oxw();return t.KtG(l.toggleExpandedRow(c))}),t.qZA()}if(2&e){const n=a.$implicit,i=t.oxw();t.Q6J("ngClass",t.VKq(1,xt,i.expandedElement===n))}}function kt(e,a){1&e&&t._UZ(0,"mat-row",46)}function St(e,a){if(1&e&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&e){const n=t.oxw(2);t.xp6(1),t.AsE("",n.TKey.COMMON.EDIT," - ",n.recordToEdit.Type,"")}}function Ot(e,a){if(1&e&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&e){const n=t.oxw(2);t.xp6(1),t.Oqu(n.TKey.COMMON.ADD)}}function Zt(e,a){1&e&&t.GkF(0)}function Dt(e,a){if(1&e){const n=t.EpF();t.TgZ(0,"de-dialog",47),t.NdJ("closeDialog",function(){t.CHM(n);const o=t.oxw();return t.KtG(o.hideEditDetailsDialog())}),t.ynx(1,48),t.YNc(2,St,2,2,"span",3),t.YNc(3,Ot,2,1,"span",3),t.BQk(),t.ynx(4,49),t.YNc(5,Zt,1,0,"ng-container",44),t.BQk(),t.ynx(6,50),t.TgZ(7,"button",51),t.NdJ("click",function(){t.CHM(n);const o=t.oxw();return t.KtG(o.hideEditDetailsDialog())}),t.TgZ(8,"div",52)(9,"mat-icon"),t._uU(10,"close"),t.qZA(),t.TgZ(11,"span"),t._uU(12),t.qZA()()(),t.TgZ(13,"button",53),t.NdJ("click",function(){t.CHM(n);const o=t.oxw();return t.KtG(o.saveOrUpdateTask())}),t.TgZ(14,"div",52)(15,"mat-icon"),t._uU(16,"check"),t.qZA(),t.TgZ(17,"span"),t._uU(18),t.qZA()()(),t.BQk(),t.qZA()}if(2&e){const n=t.oxw(),i=t.MAs(21);t.xp6(2),t.Q6J("ngIf",n.recordToEdit.ID),t.xp6(1),t.Q6J("ngIf",!n.recordToEdit.ID),t.xp6(2),t.Q6J("ngTemplateOutlet",i)("ngTemplateOutletContext",t.VKq(6,O,n.recordToEdit)),t.xp6(7),t.Oqu(n.TKey.COMMON.CANCEL),t.xp6(6),t.Oqu(n.recordToEdit.ID?n.TKey.COMMON.UPDATE:n.TKey.COMMON.SAVE)}}const wt=function(e,a,n,i){return{"bold-text":e,"danger-text":a,"warning-text":n,"primary-text":i}};function Nt(e,a){if(1&e&&(t.TgZ(0,"tr")(1,"td",56),t._uU(2),t.qZA(),t.TgZ(3,"td",28),t._uU(4),t.qZA()()),2&e){const n=a.$implicit,i=t.oxw().$implicit;t.xp6(2),t.hij("",n,": "),t.xp6(1),t.Q6J("ngClass",t.l5B(3,wt,"Priority"===n,"High"===i[n],"Medium"===i[n],"Low"===i[n])),t.xp6(1),t.Oqu(i[n+"Str"]||i[n])}}function At(e,a){if(1&e&&(t.TgZ(0,"table",54),t.YNc(1,Nt,5,8,"tr",55),t.qZA()),2&e){const n=t.oxw();t.xp6(1),t.Q6J("ngForOf",n.detailViewInfo)}}function Mt(e,a){if(1&e&&(t.TgZ(0,"mat-option",64),t._uU(1),t.qZA()),2&e){const n=a.$implicit;t.Q6J("value",n),t.xp6(1),t.Oqu(n)}}function yt(e,a){if(1&e&&(t.TgZ(0,"mat-option",64),t._uU(1),t.qZA()),2&e){const n=a.$implicit;t.Q6J("value",n),t.xp6(1),t.Oqu(n)}}function vt(e,a){if(1&e&&(t.TgZ(0,"mat-option",64),t._uU(1),t.qZA()),2&e){const n=a.$implicit;t.Q6J("value",n),t.xp6(1),t.Oqu(n)}}const g=function(e){return{readonly:e}};function bt(e,a){if(1&e){const n=t.EpF();t.TgZ(0,"mat-form-field",28)(1,"mat-label"),t._uU(2),t.qZA(),t.TgZ(3,"input",61),t.NdJ("ngModelChange",function(o){t.CHM(n);const c=t.oxw().$implicit;return t.KtG(c.Title=o)}),t.qZA()()}if(2&e){const n=t.oxw().$implicit,i=t.oxw();t.Q6J("ngClass",t.VKq(3,g,!i.authService.isTasksAdmin())),t.xp6(2),t.Oqu(i.TKey.COMMON.TITLE),t.xp6(1),t.Q6J("ngModel",n.Title)}}function Qt(e,a){if(1&e&&(t.TgZ(0,"mat-option",64),t._uU(1),t.qZA()),2&e){const n=a.$implicit;t.Q6J("value",n),t.xp6(1),t.Oqu(n)}}function Jt(e,a){if(1&e){const n=t.EpF();t.TgZ(0,"mat-form-field",65)(1,"mat-label"),t._uU(2),t.qZA(),t.TgZ(3,"input",61),t.NdJ("ngModelChange",function(o){t.CHM(n);const c=t.oxw().$implicit;return t.KtG(c.OpenDateStr=o)}),t.qZA()()}if(2&e){const n=t.oxw().$implicit,i=t.oxw();t.xp6(2),t.Oqu(i.TKey.COMMON.OPEN_DATE),t.xp6(1),t.Q6J("ngModel",n.OpenDateStr)}}function Lt(e,a){if(1&e){const n=t.EpF();t.TgZ(0,"mat-form-field",65)(1,"mat-label"),t._uU(2),t.qZA(),t.TgZ(3,"input",61),t.NdJ("ngModelChange",function(o){t.CHM(n);const c=t.oxw().$implicit;return t.KtG(c.DoneDateStr=o)}),t.qZA()()}if(2&e){const n=t.oxw().$implicit,i=t.oxw();t.xp6(2),t.Oqu(i.TKey.COMMON.DONE_DATE),t.xp6(1),t.Q6J("ngModel",n.DoneDateStr)}}function It(e,a){if(1&e){const n=t.EpF();t.TgZ(0,"mat-form-field",28)(1,"mat-label"),t._uU(2),t.qZA(),t.TgZ(3,"mat-select",57),t.NdJ("ngModelChange",function(o){const l=t.CHM(n).$implicit;return t.KtG(l.Priority=o)}),t.YNc(4,Mt,2,2,"mat-option",58),t.qZA()(),t.TgZ(5,"mat-form-field",28)(6,"mat-label"),t._uU(7),t.qZA(),t.TgZ(8,"mat-select",57),t.NdJ("ngModelChange",function(o){const l=t.CHM(n).$implicit;return t.KtG(l.Type=o)}),t.YNc(9,yt,2,2,"mat-option",58),t.qZA()(),t.TgZ(10,"mat-form-field",28)(11,"mat-label"),t._uU(12),t.qZA(),t.TgZ(13,"mat-select",59),t.NdJ("ngModelChange",function(o){const l=t.CHM(n).$implicit;return t.KtG(l.AssignedToArr=o)}),t.YNc(14,vt,2,2,"mat-option",58),t.qZA()(),t.YNc(15,bt,4,5,"mat-form-field",60),t.TgZ(16,"mat-form-field",28)(17,"mat-label"),t._uU(18),t.qZA(),t.TgZ(19,"textarea",61),t.NdJ("ngModelChange",function(o){const l=t.CHM(n).$implicit;return t.KtG(l.Details=o)}),t.qZA(),t.TgZ(20,"button",62),t.NdJ("click",function(){const c=t.CHM(n).$implicit;return t.KtG(c.Details="")}),t.TgZ(21,"mat-icon"),t._uU(22,"close"),t.qZA()()(),t.TgZ(23,"mat-form-field")(24,"mat-label"),t._uU(25),t.qZA(),t.TgZ(26,"textarea",61),t.NdJ("ngModelChange",function(o){const l=t.CHM(n).$implicit;return t.KtG(l.Notes=o)}),t.qZA(),t.TgZ(27,"button",62),t.NdJ("click",function(){const c=t.CHM(n).$implicit;return t.KtG(c.Notes="")}),t.TgZ(28,"mat-icon"),t._uU(29,"close"),t.qZA()()(),t.TgZ(30,"mat-form-field")(31,"mat-label"),t._uU(32),t.qZA(),t.TgZ(33,"mat-select",57),t.NdJ("ngModelChange",function(o){const l=t.CHM(n).$implicit;return t.KtG(l.Status=o)}),t.YNc(34,Qt,2,2,"mat-option",58),t.qZA()(),t.YNc(35,Jt,4,2,"mat-form-field",63),t.YNc(36,Lt,4,2,"mat-form-field",63)}if(2&e){const n=a.$implicit,i=t.oxw();t.Q6J("ngClass",t.VKq(23,g,!i.authService.isTasksAdmin())),t.xp6(2),t.Oqu(i.TKey.COMMON.PRIORITY),t.xp6(1),t.Q6J("ngModel",n.Priority),t.xp6(1),t.Q6J("ngForOf",i.settingsService.metadata.taskPriority),t.xp6(1),t.Q6J("ngClass",t.VKq(25,g,!i.authService.isTasksAdmin())),t.xp6(2),t.Oqu(i.TKey.COMMON.TYPE),t.xp6(1),t.Q6J("ngModel",n.Type),t.xp6(1),t.Q6J("ngForOf",i.settingsService.metadata.taskType),t.xp6(1),t.Q6J("ngClass",t.VKq(27,g,!i.authService.isTasksAdmin())),t.xp6(2),t.Oqu(i.TKey.COMMON.ASSIGNED_TO),t.xp6(1),t.Q6J("ngModel",n.AssignedToArr),t.xp6(1),t.Q6J("ngForOf",i.loginUsers),t.xp6(1),t.Q6J("ngIf",n.ID),t.xp6(1),t.Q6J("ngClass",t.VKq(29,g,!i.authService.isTasksAdmin())),t.xp6(2),t.Oqu(i.TKey.COMMON.DETAILS),t.xp6(1),t.Q6J("ngModel",n.Details),t.xp6(6),t.Oqu(i.TKey.COMMON.NOTES),t.xp6(1),t.Q6J("ngModel",n.Notes),t.xp6(6),t.Oqu(i.TKey.COMMON.STATUS),t.xp6(1),t.Q6J("ngModel",n.Status),t.xp6(1),t.Q6J("ngForOf",i.tasksStatus),t.xp6(1),t.Q6J("ngIf",n.ID),t.xp6(1),t.Q6J("ngIf",n.ID)}}function Et(e,a){if(1&e){const n=t.EpF();t.TgZ(0,"de-confirmation-dialog",66),t.NdJ("onSuccess",function(){t.CHM(n);const o=t.oxw();return t.KtG(o.deleteRecord())})("onCancel",function(){t.CHM(n);const o=t.oxw();return t.KtG(o.recordToDelete=null)}),t.qZA()}if(2&e){const n=t.oxw();t.Q6J("title","Delete Patrol?")("content","Are you sure you want to delete task '"+n.recordToDelete.Type+"'?")}}const qt=function(){return["expandedDetail"]},Ut=function(){return[25,50,100,150]};class p extends k.H6{constructor(){super(...arguments),this.durationColName="Duration",this.data=new r.by([]),this.fullData=[],this.activeTaskStatus="Open",this.taskColumns=this.settingsService.metadata.sheetsInfo?.TASKS?.cols,this.detailViewInfo=[this.taskColumns?.TYPE?.label||"",this.taskColumns?.PRIORITY?.label||"",this.taskColumns?.TITLE?.label||"",this.taskColumns?.ASSIGNEDTO?.label||"",this.taskColumns?.DETAILS?.label||"",this.taskColumns?.NOTES?.label||"",this.taskColumns?.OPENDATE?.label||"",this.taskColumns?.DONEDATE?.label||""],this.allColumns=[this.taskColumns?.PRIORITY?.label||"",this.taskColumns?.TYPE?.label||"",this.taskColumns?.TITLE?.label||"",this.durationColName,this.taskColumns?.ASSIGNEDTO?.label||""],this.displayedColumns=[],this.searchText="",this.searchTextRegexp=new RegExp(""),this.cacheInfo=null,this.tasksStatus=this.settingsService.metadata.taskStatus,this.loginUsers=this.settingsService.metadata.loginUsers?.filter(a=>!a.match(/(test|service)/i))}ngOnInit(){this.filterSearch=this.filterSearch.bind(this),this.filterTaskStatus=this.filterTaskStatus.bind(this),this._subscriptions.push(this.eventService.isMobile.subscribe(()=>this.refreshDisplayedColumns())),this.settingsService.pageTitle=this.TKey.COMMON.CABLE,this.authService.isTasksAdmin()||(this.tasksStatus=this.settingsService.metadata.taskStatus?.slice(0,this.settingsService.metadata.taskStatus.length-1))}ngAfterViewInit(){this.data.sort=this.sort,this.data.paginator=this.paginator,this.refreshDisplayedColumns(),this.refreshData(!1,!0)}ngOnDestroy(){super.ngOnDestroy(),this.cacheInfo?.destroy()}refreshDisplayedColumns(){this.displayedColumns=this.authService.isTasksAdmin()&&!this.settingsService.isMobile?this.allColumns.slice(0,5):this.allColumns.slice(0,4),this.displayedColumns.push("ACTIONS")}hideEditDetailsDialog(){this.recordToEdit=null,this.recordToEditOrig=null}saveOrUpdateTask(){if(!this.recordToEdit)return;this.settingsService.processingText="Updating data...";const a=this.recordToEdit.clone();a.ID=a.ID||Date.now().toString(),a.OpenDate=a.getOpenCloseDate(a.OpenDate||Date.now()),a.AssignedTo=a.AssignedTo,this.recordToEditOrig?.Status!==a.Status&&"Done"===a.Status&&(a.DoneDate=a.getOpenCloseDate(Date.now())),this.apiGSheetDataService.saveOrUpdateRecord(this.settingsService.metadata.sheetsInfo?.TASKS?.label,[this.taskColumns?.ID?.label],a).subscribe({next:()=>{this.settingsService.processingText="",this.refreshData(!0)},error:n=>{this.settingsService.processingText="",this.utilService.openErrorSnackBar(n,"Close")}})}refreshData(a=!1,n=!1){this.settingsService.processingText="Refreshing data...",this.apiGSheetDataService.getSheetData(this.settingsService.metadata.sheetsInfo?.TASKS.label,C.Oo,a).pipe((0,N.b)(i=>this.getRefreshCacheInfo(`SHEET_${this.settingsService.metadata.sheetsInfo?.TASKS.label}`,this.cacheInfo).pipe((0,A.U)(o=>(this.cacheInfo=o,i))))).subscribe({next:i=>{this.settingsService.processingText="",this.fullData=this.authService.isTasksAdmin()?i:i.filter(o=>o.isAssignedTo(this.authService.Username)),this.initializeFilters(n)},error:()=>this.settingsService.processingText="",complete:()=>{this.recordToDelete=null,this.hideEditDetailsDialog()}})}initializeFilters(a=!1){this.onFilterChange()}onFilterChange(){this.immediateFilterChange()}filterSearch(a){return a.freeTextSearch(this.searchTextRegexp)}filterTaskStatus(a){return a.Status===this.activeTaskStatus}createRecord(){this.recordToEditOrig=null,this.recordToEdit=new C.Oo({Date:new Date,By:this.authService.Username,Status:"Open"})}editRecord(a){this.recordToEditOrig=a,this.recordToEdit=a.clone()}deleteRecord(){this.settingsService.processingText="Deleting record...",this.apiGSheetDataService.deleteRecord(this.settingsService.metadata.sheetsInfo?.TASKS?.label,[this.taskColumns?.ID?.label],this.recordToDelete).subscribe({next:()=>{this.settingsService.processingText="",this.refreshData(!0)},error:a=>{this.settingsService.processingText="",this.utilService.openErrorSnackBar(a,"Close")}})}getCellClassNames(a,n){return""}toggleExpandedRow(a){this.expandedElement=this.expandedElement===a?null:a}selectedTabChange(a){switch(a.index){case 0:default:this.activeTaskStatus="Open";break;case 1:this.activeTaskStatus="Done";break;case 2:this.activeTaskStatus="Verified"}this.immediateFilterChange()}immediateFilterChange(){let n=this.filterSearch,i=this.filterTaskStatus;this.searchText?this.searchTextRegexp=this.utilService.getFlexibleSearchTextRegexp(this.searchText):n=o=>!0,this.data.data=this.fullData.filter(n).filter(i)}static#t=this.\u0275fac=function(){let a;return function(i){return(a||(a=t.n5z(p)))(i||p)}}();static#e=this.\u0275cmp=t.Xpm({type:p,selectors:[["de-tasks-list"]],viewQuery:function(n,i){if(1&n&&(t.Gf(d.YE,5),t.Gf(x.NW,5)),2&n){let o;t.iGM(o=t.CRH())&&(i.sort=o.first),t.iGM(o=t.CRH())&&(i.paginator=o.first)}},features:[t.qOj],decls:23,vars:15,consts:[["mat-stretch-tabs","true","mat-align-tabs","center",3,"selectedTabChange"],["labelClass","de-p-hsmall--force"],["mat-tab-label",""],[4,"ngIf"],[1,"de-f-aligncenter","de-f-justifyright","de-m-vbase","de-sm-rbase-nolast"],["mat-raised-button","","color","accent",3,"click",4,"ngIf"],[3,"cacheInfo","refreshTriggerInterval","refresh"],["matSort","","matSortActive","Priority","matSortDirection","asc","multiTemplateDataRows","",1,"mat-elevation-z8",3,"dataSource"],[3,"matColumnDef",4,"ngFor","ngForOf"],["matColumnDef","expandedDetail"],["class","expanded-detail-cell",3,"ngClass",4,"matCellDef"],[4,"matHeaderRowDef","matHeaderRowDefSticky"],[3,"ngClass","click",4,"matRowDef","matRowDefColumns"],["mat-row","","class","expanded-detail-row",4,"matRowDef","matRowDefColumns"],["pageSize","50","showFirstLastButtons","",3,"pageSizeOptions"],["classNames","customer-card-dialog",3,"closeDialog",4,"ngIf"],["taskDetailViewReadOnly",""],["taskDetailView",""],[3,"title","content","onSuccess","onCancel",4,"ngIf"],[1,"de-m-rbase"],["mat-raised-button","","color","accent",3,"click"],[3,"matColumnDef"],["mat-sort-header","",3,"ngClass",4,"matHeaderCellDef"],[3,"ngClass",4,"matCellDef"],["mat-sort-header","",3,"ngClass"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"ngClass"],[1,"success-text"],[1,"danger-text"],[1,"primary-text"],["class","mobile-cell de-sm-rsmall-nolast",4,"ngIf"],[1,"mobile-cell","de-sm-rsmall-nolast"],[3,"text"],[1,"de-f-aligncenter","de-sm-rbase-nolast"],["displayType","CALL",3,"mobile"],["displayType","WHATSAPP",3,"mobile"],["color","primary",1,"de-cursorpointer","de-m-rbase",3,"click"],["color","warn","class","de-cursorpointer",3,"click",4,"ngIf"],["color","warn",1,"de-cursorpointer",3,"click"],[1,"expanded-detail-cell",3,"ngClass"],["class","de-p-bmedium de-p-tbase de-w-full",4,"ngIf"],[1,"de-p-bmedium","de-p-tbase","de-w-full"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"ngClass","click"],["mat-row","",1,"expanded-detail-row"],["classNames","customer-card-dialog",3,"closeDialog"],["de-dialog-header",""],["de-dialog-body",""],["de-dialog-footer",""],["mat-raised-button","","color","warn",3,"click"],[1,"de-f-aligncenter","de-sm-rsmall-nolast"],["mat-raised-button","","color","primary",3,"click"],[1,"de-w-full"],[4,"ngFor","ngForOf"],[2,"min-width","90px","max-width","120px"],[3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["multiple","",3,"ngModel","ngModelChange"],[3,"ngClass",4,"ngIf"],["matInput","","type","text",3,"ngModel","ngModelChange"],["matSuffix","","mat-icon-button","",3,"click"],["class","readonly",4,"ngIf"],[3,"value"],[1,"readonly"],[3,"title","content","onSuccess","onCancel"]],template:function(n,i){1&n&&(t.TgZ(0,"mat-tab-group",0),t.NdJ("selectedTabChange",function(c){return i.selectedTabChange(c)}),t.TgZ(1,"mat-tab",1),t.YNc(2,U,3,0,"ng-template",2),t.qZA(),t.TgZ(3,"mat-tab"),t.YNc(4,Y,3,0,"ng-template",2),t.qZA(),t.YNc(5,$,2,0,"mat-tab",3),t.qZA(),t.TgZ(6,"div",4),t.YNc(7,F,4,1,"button",5),t.TgZ(8,"de-refresh-data",6),t.NdJ("refresh",function(){return i.refreshData(!0)}),t.qZA()(),t.TgZ(9,"mat-table",7),t.YNc(10,dt,3,1,"ng-container",8),t.ynx(11,9),t.YNc(12,ft,2,3,"mat-cell",10),t.BQk(),t.YNc(13,ht,1,0,"mat-header-row",11),t.YNc(14,Ct,1,3,"mat-row",12),t.YNc(15,kt,1,0,"mat-row",13),t.qZA(),t._UZ(16,"mat-paginator",14),t.YNc(17,Dt,19,8,"de-dialog",15),t.YNc(18,At,2,1,"ng-template",null,16,t.W1O),t.YNc(20,It,37,31,"ng-template",null,17,t.W1O),t.YNc(22,Et,1,2,"de-confirmation-dialog",18)),2&n&&(t.xp6(5),t.Q6J("ngIf",i.authService.isTasksAdmin()),t.xp6(2),t.Q6J("ngIf",i.settingsService.isOnline&&"Open"===i.activeTaskStatus),t.xp6(1),t.Q6J("cacheInfo",i.cacheInfo)("refreshTriggerInterval",4320),t.xp6(1),t.Q6J("dataSource",i.data),t.xp6(1),t.Q6J("ngForOf",i.displayedColumns),t.xp6(3),t.Q6J("matHeaderRowDef",i.displayedColumns)("matHeaderRowDefSticky",!0),t.xp6(1),t.Q6J("matRowDefColumns",i.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",t.DdM(13,qt)),t.xp6(1),t.Q6J("pageSizeOptions",t.DdM(14,Ut)),t.xp6(1),t.Q6J("ngIf",i.recordToEdit),t.xp6(5),t.Q6J("ngIf",i.recordToDelete))},dependencies:[y.z,v.$,b.a,Q.D,J.s,m.mk,m.sg,m.O5,m.tP,m.RF,m.n9,m.ED,u.Fj,u.JJ,u.On,L.ey,S.lW,S.RK,T.KE,T.hX,T.R9,I.Hw,E.Nt,d.YE,d.nU,x.NW,q.gD,r.BZ,r.fO,r.as,r.w1,r.Dz,r.nj,r.ge,r.ev,r.XQ,r.Gk,f.uD,f.uX,f.SP],styles:["[_nghost-%COMP%]{display:block;padding:12px;height:100%;width:100%}",'mat-header-cell[_ngcontent-%COMP%]:first-child:not([colspan="10"]), mat-cell[_ngcontent-%COMP%]:first-child:not([colspan="10"]), mat-header-cell[_ngcontent-%COMP%]:nth-child(2), mat-cell[_ngcontent-%COMP%]:nth-child(2){align-items:center;justify-content:center;padding:0!important;max-width:36px!important;width:36px!important}mat-header-cell[_ngcontent-%COMP%]:first-child:not([colspan="10"]), mat-cell[_ngcontent-%COMP%]:first-child:not([colspan="10"]){padding-left:12px!important}.highlight-row[_ngcontent-%COMP%]{background-color:#f0f0f0}.expanded-detail-row[_ngcontent-%COMP%]{min-height:0px}table[_ngcontent-%COMP%]{line-height:24px}'],data:{animation:[(0,_.X$)("detailExpand",[(0,_.SB)("collapsed",(0,_.oB)({height:"0px",minHeight:"0"})),(0,_.SB)("expanded",(0,_.oB)({height:"*"})),(0,_.eR)("expanded <=> collapsed",(0,_.jt)("225ms cubic-bezier(0.4, 0.0, 0.2, 1)"))])]}})}(0,w.gn)([(0,M.Ds)(500)],p.prototype,"onFilterChange",null);var Z=s(1896);const Yt=[{path:"list",component:p},{path:"**",redirectTo:"list"}];let D=(()=>{class e{static#t=this.\u0275fac=function(i){return new(i||e)};static#e=this.\u0275mod=t.oAB({type:e});static#n=this.\u0275inj=t.cJS({imports:[Z.Bz.forChild(Yt),Z.Bz]})}return e})();s(8313);let Kt=(()=>{class e{static#t=this.\u0275fac=function(i){return new(i||e)};static#e=this.\u0275mod=t.oAB({type:e});static#n=this.\u0275inj=t.cJS({imports:[k.nC.forChild(),D]})}return e})()}}]);