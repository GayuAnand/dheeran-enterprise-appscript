"use strict";(self.webpackChunkcap_webview=self.webpackChunkcap_webview||[]).push([[298],{8298:(jt,x,s)=>{s.r(x),s.d(x,{TasksListComponent:()=>p,TasksModule:()=>zt,TasksRoutingModule:()=>b});var N=s(5861),A=s(7582),D=s(6328),v=s(7398),g=s(3566),M=s(298),h=s(3365),r=s(5313),_=s(6825),C=s(7848),k=s(2300),t=s(5879),y=s(7917),Q=s(2099),J=s(1705),L=s(9653),U=s(3969),m=s(6814),u=s(6223),I=s(3680),S=s(2296),T=s(9157),q=s(617),E=s(2032),Y=s(8525),f=s(4104);function $(n,o){1&n&&(t.TgZ(0,"mat-icon",19),t._uU(1,"checklist"),t.qZA(),t._uU(2," Open "))}function F(n,o){1&n&&(t.TgZ(0,"mat-icon",19),t._uU(1,"done"),t.qZA(),t._uU(2," Done "))}function K(n,o){1&n&&(t.TgZ(0,"mat-icon",19),t._uU(1,"check_circle"),t.qZA(),t._uU(2," Verified "))}function R(n,o){1&n&&(t.TgZ(0,"mat-tab"),t.YNc(1,K,3,0,"ng-template",2),t.qZA())}function B(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"button",20),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.createRecord())}),t.TgZ(1,"mat-icon"),t._uU(2,"add"),t.qZA(),t._uU(3),t.qZA()}if(2&n){const e=t.oxw();t.xp6(3),t.Oqu(e.TKey.COMMON.ADD)}}function G(n,o){1&n&&t.GkF(0)}function H(n,o){1&n&&t.GkF(0)}function P(n,o){1&n&&t.GkF(0)}function V(n,o){if(1&n&&(t.ynx(0),t._uU(1),t.BQk()),2&n){const e=t.oxw(3);t.xp6(1),t.Oqu(e.TKey.COMMON.DURATION)}}function z(n,o){if(1&n&&(t.ynx(0),t._uU(1),t.BQk()),2&n){const e=t.oxw(2).$implicit;t.xp6(1),t.Oqu(e)}}function j(n,o){if(1&n&&(t.TgZ(0,"mat-header-cell",24),t.ynx(1,25),t.YNc(2,G,1,0,"ng-container",26),t.YNc(3,H,1,0,"ng-container",26),t.YNc(4,P,1,0,"ng-container",26),t.YNc(5,V,2,1,"ng-container",26),t.YNc(6,z,2,1,"ng-container",27),t.BQk(),t.qZA()),2&n){const e=t.oxw().$implicit,i=t.oxw();t.Q6J("ngClass","de-f-justifycenter"),t.xp6(1),t.Q6J("ngSwitch",e),t.xp6(1),t.Q6J("ngSwitchCase","ACTIONS"),t.xp6(1),t.Q6J("ngSwitchCase","UiPriority"),t.xp6(1),t.Q6J("ngSwitchCase","Type"),t.xp6(1),t.Q6J("ngSwitchCase",i.durationColName)}}const Z=function(n,o,e){return{"danger-text":n,"warning-text":o,"primary-text":e}};function W(n,o){if(1&n&&(t.ynx(0),t.TgZ(1,"mat-icon",28),t._uU(2,"stars"),t.qZA(),t.BQk()),2&n){const e=t.oxw().$implicit,i=t.oxw().$implicit;t.xp6(1),t.Q6J("ngClass",t.kEZ(1,Z,"High"===e[i],"Intermediate"===e[i],"Low"===e[i]))}}function X(n,o){1&n&&(t.ynx(0),t.TgZ(1,"mat-icon",29),t._uU(2,"wifi"),t.qZA(),t.BQk())}function tt(n,o){1&n&&(t.ynx(0),t.TgZ(1,"mat-icon",30),t._uU(2,"wifi"),t.qZA(),t.BQk())}function et(n,o){1&n&&(t.ynx(0),t.TgZ(1,"mat-icon",29),t._uU(2,"cable"),t.qZA(),t.BQk())}function nt(n,o){1&n&&(t.ynx(0),t.TgZ(1,"mat-icon",30),t._uU(2,"cable"),t.qZA(),t.BQk())}function it(n,o){1&n&&(t.ynx(0),t.TgZ(1,"mat-icon",31),t._uU(2,"task"),t.qZA(),t.BQk())}function ot(n,o){if(1&n&&(t.ynx(0)(1,25),t.YNc(2,X,3,0,"ng-container",26),t.YNc(3,tt,3,0,"ng-container",26),t.YNc(4,et,3,0,"ng-container",26),t.YNc(5,nt,3,0,"ng-container",26),t.YNc(6,it,3,0,"ng-container",27),t.BQk()()),2&n){const e=t.oxw().$implicit,i=t.oxw().$implicit;t.xp6(1),t.Q6J("ngSwitch",e[i]),t.xp6(1),t.Q6J("ngSwitchCase","Internet Lead"),t.xp6(1),t.Q6J("ngSwitchCase","Internet Fault"),t.xp6(1),t.Q6J("ngSwitchCase","Cable Lead"),t.xp6(1),t.Q6J("ngSwitchCase","Cable Fault")}}function at(n,o){if(1&n&&(t.ynx(0),t._uU(1),t.BQk()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.DurationInHumanizeFormat)}}function st(n,o){if(1&n&&(t.ynx(0),t._uU(1),t.BQk()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.OpenDateStr)}}function ct(n,o){if(1&n&&(t.ynx(0),t._uU(1),t.BQk()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.DoneDateStr)}}function lt(n,o){if(1&n&&(t.TgZ(0,"div",33),t._UZ(1,"de-copyable-text",34),t.TgZ(2,"div",35),t._UZ(3,"de-mobile-number",36)(4,"de-mobile-number",37),t.qZA()()),2&n){const e=t.oxw(2).$implicit,i=t.oxw().$implicit;t.xp6(1),t.Q6J("text",e[i]),t.xp6(2),t.Q6J("mobile",e[i]),t.xp6(1),t.Q6J("mobile",e[i])}}function rt(n,o){if(1&n&&(t.ynx(0),t.YNc(1,lt,5,3,"div",32),t.BQk()),2&n){const e=t.oxw().$implicit,i=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",e[i])}}function _t(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"mat-icon",40),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(3).$implicit,c=t.oxw(2);return t.KtG(c.recordToDelete=a)}),t._uU(1,"delete"),t.qZA()}}function mt(n,o){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"mat-icon",38),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(2).$implicit,c=t.oxw(2);return t.KtG(c.editRecord(a))}),t._uU(2,"edit"),t.qZA(),t.YNc(3,_t,2,0,"mat-icon",39),t.BQk()}if(2&n){const e=t.oxw(4);t.xp6(3),t.Q6J("ngIf",e.authService.isTasksAdmin())}}function pt(n,o){if(1&n&&(t.ynx(0),t.YNc(1,mt,4,1,"ng-container",3),t.BQk()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",null==e?null:e.ID)}}function dt(n,o){if(1&n&&(t.ynx(0),t._uU(1),t.BQk()),2&n){const e=t.oxw().$implicit,i=t.oxw().$implicit;t.xp6(1),t.Oqu(e[i])}}function gt(n,o){if(1&n&&(t.TgZ(0,"mat-cell",28),t.ynx(1,25),t.YNc(2,W,3,5,"ng-container",26),t.YNc(3,ot,7,5,"ng-container",26),t.YNc(4,at,2,1,"ng-container",26),t.YNc(5,st,2,1,"ng-container",26),t.YNc(6,ct,2,1,"ng-container",26),t.YNc(7,rt,2,1,"ng-container",26),t.YNc(8,pt,2,1,"ng-container",26),t.YNc(9,dt,2,1,"ng-container",27),t.BQk(),t.qZA()),2&n){const e=o.$implicit,i=t.oxw().$implicit,a=t.oxw();t.Q6J("ngClass",a.getCellClassNames(e,i)),t.xp6(1),t.Q6J("ngSwitch",i),t.xp6(1),t.Q6J("ngSwitchCase","UiPriority"),t.xp6(1),t.Q6J("ngSwitchCase","Type"),t.xp6(1),t.Q6J("ngSwitchCase",a.durationColName),t.xp6(1),t.Q6J("ngSwitchCase","OpenDate"),t.xp6(1),t.Q6J("ngSwitchCase","DoneDate"),t.xp6(1),t.Q6J("ngSwitchCase","MOBILE"),t.xp6(1),t.Q6J("ngSwitchCase","ACTIONS")}}function ut(n,o){1&n&&(t.ynx(0,21),t.YNc(1,j,7,6,"mat-header-cell",22),t.YNc(2,gt,10,9,"mat-cell",23),t.BQk()),2&n&&t.s9C("matColumnDef",o.$implicit)}function Tt(n,o){1&n&&t.GkF(0)}const O=function(n){return{$implicit:n}};function ft(n,o){if(1&n&&(t.TgZ(0,"div",43),t.YNc(1,Tt,1,0,"ng-container",44),t.qZA()),2&n){const e=t.oxw().$implicit;t.oxw();const i=t.MAs(19);t.xp6(1),t.Q6J("ngTemplateOutlet",i)("ngTemplateOutletContext",t.VKq(2,O,e))}}function xt(n,o){if(1&n&&(t.TgZ(0,"mat-cell",41),t.YNc(1,ft,2,4,"div",42),t.qZA()),2&n){const e=o.$implicit,i=t.oxw();t.Q6J("ngClass",e!==i.expandedElement?"de-noborder--force":""),t.uIk("colspan",10),t.xp6(1),t.Q6J("ngIf",e===i.expandedElement)}}function ht(n,o){1&n&&t._UZ(0,"mat-header-row")}const Ct=function(n){return{"highlight-row":n}};function kt(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"mat-row",45),t.NdJ("click",function(){const c=t.CHM(e).$implicit,l=t.oxw();return t.KtG(l.toggleExpandedRow(c))}),t.qZA()}if(2&n){const e=o.$implicit,i=t.oxw();t.Q6J("ngClass",t.VKq(1,Ct,i.expandedElement===e))}}function St(n,o){1&n&&t._UZ(0,"mat-row",46)}function Zt(n,o){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.AsE("",e.TKey.COMMON.EDIT," - ",e.recordToEdit.Type,"")}}function Ot(n,o){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.Oqu(e.TKey.COMMON.ADD)}}function wt(n,o){1&n&&t.GkF(0)}function bt(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"de-dialog",47),t.NdJ("closeDialog",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.hideEditDetailsDialog())}),t.ynx(1,48),t.YNc(2,Zt,2,2,"span",3),t.YNc(3,Ot,2,1,"span",3),t.BQk(),t.ynx(4,49),t.YNc(5,wt,1,0,"ng-container",44),t.BQk(),t.ynx(6,50),t.TgZ(7,"button",51),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.hideEditDetailsDialog())}),t.TgZ(8,"div",52)(9,"mat-icon"),t._uU(10,"close"),t.qZA(),t.TgZ(11,"span"),t._uU(12),t.qZA()()(),t.TgZ(13,"button",53),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.saveOrUpdateTask())}),t.TgZ(14,"div",52)(15,"mat-icon"),t._uU(16,"check"),t.qZA(),t.TgZ(17,"span"),t._uU(18),t.qZA()()(),t.BQk(),t.qZA()}if(2&n){const e=t.oxw(),i=t.MAs(21);t.xp6(2),t.Q6J("ngIf",e.recordToEdit.ID),t.xp6(1),t.Q6J("ngIf",!e.recordToEdit.ID),t.xp6(2),t.Q6J("ngTemplateOutlet",i)("ngTemplateOutletContext",t.VKq(6,O,e.recordToEdit)),t.xp6(7),t.Oqu(e.TKey.COMMON.CANCEL),t.xp6(6),t.Oqu(e.recordToEdit.ID?e.TKey.COMMON.UPDATE:e.TKey.COMMON.SAVE)}}function Nt(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"td",58)(1,"button",59),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(2).$implicit,c=t.oxw();return t.KtG(c.sendTaskReminder(a,!0,!0))}),t._UZ(2,"mat-icon",60),t._uU(3,"FTTH New"),t.qZA(),t.TgZ(4,"button",59),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(2).$implicit,c=t.oxw();return t.KtG(c.sendTaskReminder(a,!0,!1))}),t._UZ(5,"mat-icon",60),t._uU(6,"FTTH Updated"),t.qZA(),t.TgZ(7,"button",59),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(2).$implicit,c=t.oxw();return t.KtG(c.sendTaskReminder(a,!1,!0))}),t._UZ(8,"mat-icon",60),t._uU(9,"UG New"),t.qZA(),t.TgZ(10,"button",59),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(2).$implicit,c=t.oxw();return t.KtG(c.sendTaskReminder(a,!1,!1))}),t._UZ(11,"mat-icon",60),t._uU(12,"UG Updated"),t.qZA()()}}function At(n,o){if(1&n&&(t.TgZ(0,"td",61),t._uU(1),t.qZA()),2&n){const e=t.oxw().$implicit,i=t.oxw().$implicit;t.Q6J("ngClass",t.kEZ(2,Z,"High"===i[e],"Medium"===i[e],"Low"===i[e])),t.xp6(1),t.Oqu(i[e])}}function Dt(n,o){if(1&n&&(t.TgZ(0,"div",52),t._UZ(1,"de-copyable-text",34),t.TgZ(2,"div",35),t._UZ(3,"de-mobile-number",36)(4,"de-mobile-number",37),t.qZA()()),2&n){const e=o.$implicit;t.xp6(1),t.Q6J("text",e),t.xp6(2),t.Q6J("mobile",e),t.xp6(1),t.Q6J("mobile",e)}}function vt(n,o){if(1&n&&(t.TgZ(0,"div",64)(1,"a",65)(2,"mat-icon"),t._uU(3,"location_on"),t.qZA()(),t._UZ(4,"de-copyable-text",66),t.qZA()),2&n){const e=o.$implicit,i=t.oxw(4);t.xp6(1),t.Q6J("href",i.geolocationService.getGoogleLocationUrl(e[0],e[1]),t.LSH),t.xp6(3),t.FAE("displayText","",i.TKey.COMMON.LAT_ABBR,": ",e[0]||0,", ",i.TKey.COMMON.LON_ABBR,": ",e[1]||0,""),t.Q6J("text",i.geolocationService.getGoogleLocationUrl(e[0],e[1]))}}function Mt(n,o){if(1&n&&(t.ynx(0),t.TgZ(1,"td"),t.YNc(2,Dt,5,3,"div",62),t.YNc(3,vt,5,6,"div",63),t.qZA(),t.BQk()),2&n){const e=t.oxw(2).$implicit;t.xp6(2),t.Q6J("ngForOf",e.getMobileNumbersFromDetail()),t.xp6(1),t.Q6J("ngForOf",e.getLocationInfoFromDetail())}}function yt(n,o){if(1&n&&(t.ynx(0),t._uU(1),t.BQk()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.name)}}function Qt(n,o){if(1&n&&(t.ynx(0),t._UZ(1,"de-copyable-text",66),t.TgZ(2,"div",35),t._UZ(3,"de-mobile-number",36)(4,"de-mobile-number",37),t.qZA(),t.BQk()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("text",e.mobile)("displayText",e.name),t.xp6(2),t.Q6J("mobile",e.mobile),t.xp6(1),t.Q6J("mobile",e.mobile)}}function Jt(n,o){if(1&n&&(t.TgZ(0,"div",52),t.YNc(1,yt,2,1,"ng-container",3),t.YNc(2,Qt,5,4,"ng-container",3),t.qZA()),2&n){const e=o.$implicit;t.xp6(1),t.Q6J("ngIf",!e.mobile),t.xp6(1),t.Q6J("ngIf",e.mobile)}}function Lt(n,o){if(1&n&&(t.TgZ(0,"td"),t.YNc(1,Jt,3,2,"div",62),t.qZA()),2&n){const e=t.oxw(2).$implicit,i=t.oxw();t.xp6(1),t.Q6J("ngForOf",i.getAssignedUsersInfo(e))}}function Ut(n,o){if(1&n&&(t.ynx(0),t.TgZ(1,"td"),t._uU(2),t.qZA(),t.BQk()),2&n){const e=t.oxw().$implicit,i=t.oxw().$implicit;t.xp6(2),t.Oqu(i[e+"Str"]||i[e])}}function It(n,o){if(1&n&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.ynx(3,25),t.YNc(4,Nt,13,0,"td",56),t.YNc(5,At,2,6,"td",57),t.YNc(6,Mt,4,2,"ng-container",26),t.YNc(7,Lt,2,1,"td",26),t.YNc(8,Ut,3,1,"ng-container",27),t.BQk(),t.qZA()),2&n){const e=o.$implicit;t.xp6(2),t.hij("",e,": "),t.xp6(1),t.Q6J("ngSwitch",e),t.xp6(1),t.Q6J("ngSwitchCase","Reminders"),t.xp6(1),t.Q6J("ngSwitchCase","Priority"),t.xp6(1),t.Q6J("ngSwitchCase","More Details"),t.xp6(1),t.Q6J("ngSwitchCase","AssignedTo")}}function qt(n,o){if(1&n&&(t.TgZ(0,"table",54),t.YNc(1,It,9,6,"tr",55),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.detailViewInfo)}}function Et(n,o){if(1&n&&(t.TgZ(0,"mat-option",73),t._uU(1),t.qZA()),2&n){const e=o.$implicit;t.Q6J("value",e),t.xp6(1),t.Oqu(e)}}function Yt(n,o){if(1&n&&(t.TgZ(0,"mat-option",73),t._uU(1),t.qZA()),2&n){const e=o.$implicit;t.Q6J("value",e),t.xp6(1),t.Oqu(e)}}function $t(n,o){if(1&n&&(t.TgZ(0,"mat-option",73),t._uU(1),t.qZA()),2&n){const e=o.$implicit;t.Q6J("value",e.name),t.xp6(1),t.Oqu(e.name)}}function Ft(n,o){if(1&n&&(t.TgZ(0,"mat-option",73),t._uU(1),t.qZA()),2&n){const e=o.$implicit;t.Q6J("value",e),t.xp6(1),t.Oqu(e)}}function Kt(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"mat-form-field",74)(1,"mat-label"),t._uU(2),t.qZA(),t.TgZ(3,"input",70),t.NdJ("ngModelChange",function(a){t.CHM(e);const c=t.oxw().$implicit;return t.KtG(c.OpenDateStr=a)}),t.qZA()()}if(2&n){const e=t.oxw().$implicit,i=t.oxw();t.xp6(2),t.Oqu(i.TKey.COMMON.OPEN_DATE),t.xp6(1),t.Q6J("ngModel",e.OpenDateStr)}}function Rt(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"mat-form-field",74)(1,"mat-label"),t._uU(2),t.qZA(),t.TgZ(3,"input",70),t.NdJ("ngModelChange",function(a){t.CHM(e);const c=t.oxw().$implicit;return t.KtG(c.DoneDateStr=a)}),t.qZA()()}if(2&n){const e=t.oxw().$implicit,i=t.oxw();t.xp6(2),t.Oqu(i.TKey.COMMON.DONE_DATE),t.xp6(1),t.Q6J("ngModel",e.DoneDateStr)}}const d=function(n){return{readonly:n}};function Bt(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"mat-form-field",28)(1,"mat-label"),t._uU(2),t.qZA(),t.TgZ(3,"mat-select",67),t.NdJ("ngModelChange",function(a){const l=t.CHM(e).$implicit;return t.KtG(l.Priority=a)}),t.YNc(4,Et,2,2,"mat-option",68),t.qZA()(),t.TgZ(5,"mat-form-field",28)(6,"mat-label"),t._uU(7),t.qZA(),t.TgZ(8,"mat-select",67),t.NdJ("ngModelChange",function(a){const l=t.CHM(e).$implicit;return t.KtG(l.Type=a)}),t.YNc(9,Yt,2,2,"mat-option",68),t.qZA()(),t.TgZ(10,"mat-form-field",28)(11,"mat-label"),t._uU(12),t.qZA(),t.TgZ(13,"mat-select",69),t.NdJ("ngModelChange",function(a){const l=t.CHM(e).$implicit;return t.KtG(l.AssignedToArr=a)}),t.YNc(14,$t,2,2,"mat-option",68),t.qZA()(),t.TgZ(15,"mat-form-field",28)(16,"mat-label"),t._uU(17),t.qZA(),t.TgZ(18,"input",70),t.NdJ("ngModelChange",function(a){const l=t.CHM(e).$implicit;return t.KtG(l.Title=a)}),t.qZA()(),t.TgZ(19,"mat-form-field",28)(20,"mat-label"),t._uU(21),t.qZA(),t.TgZ(22,"textarea",70),t.NdJ("ngModelChange",function(a){const l=t.CHM(e).$implicit;return t.KtG(l.Details=a)}),t.qZA(),t.TgZ(23,"button",71),t.NdJ("click",function(){const c=t.CHM(e).$implicit;return t.KtG(c.Details="")}),t.TgZ(24,"mat-icon"),t._uU(25,"close"),t.qZA()()(),t.TgZ(26,"mat-form-field")(27,"mat-label"),t._uU(28),t.qZA(),t.TgZ(29,"textarea",70),t.NdJ("ngModelChange",function(a){const l=t.CHM(e).$implicit;return t.KtG(l.Notes=a)}),t.qZA(),t.TgZ(30,"button",71),t.NdJ("click",function(){const c=t.CHM(e).$implicit;return t.KtG(c.Notes="")}),t.TgZ(31,"mat-icon"),t._uU(32,"close"),t.qZA()()(),t.TgZ(33,"mat-form-field")(34,"mat-label"),t._uU(35),t.qZA(),t.TgZ(36,"mat-select",67),t.NdJ("ngModelChange",function(a){const l=t.CHM(e).$implicit;return t.KtG(l.Status=a)}),t.YNc(37,Ft,2,2,"mat-option",68),t.qZA()(),t.YNc(38,Kt,4,2,"mat-form-field",72),t.YNc(39,Rt,4,2,"mat-form-field",72)}if(2&n){const e=o.$implicit,i=t.oxw();t.Q6J("ngClass",t.VKq(25,d,!i.authService.isTasksAdmin())),t.xp6(2),t.Oqu(i.TKey.COMMON.PRIORITY),t.xp6(1),t.Q6J("ngModel",e.Priority),t.xp6(1),t.Q6J("ngForOf",i.settingsService.metadata.taskPriority),t.xp6(1),t.Q6J("ngClass",t.VKq(27,d,!i.authService.isTasksAdmin())),t.xp6(2),t.Oqu(i.TKey.COMMON.TYPE),t.xp6(1),t.Q6J("ngModel",e.Type),t.xp6(1),t.Q6J("ngForOf",i.settingsService.metadata.taskType),t.xp6(1),t.Q6J("ngClass",t.VKq(29,d,!i.authService.isTasksAdmin())),t.xp6(2),t.Oqu(i.TKey.COMMON.ASSIGNED_TO),t.xp6(1),t.Q6J("ngModel",e.AssignedToArr),t.xp6(1),t.Q6J("ngForOf",i.loginUsers),t.xp6(1),t.Q6J("ngClass",t.VKq(31,d,!i.authService.isTasksAdmin())),t.xp6(2),t.Oqu(i.TKey.COMMON.TITLE),t.xp6(1),t.Q6J("ngModel",e.Title),t.xp6(1),t.Q6J("ngClass",t.VKq(33,d,!i.authService.isTasksAdmin())),t.xp6(2),t.Oqu(i.TKey.COMMON.DETAILS),t.xp6(1),t.Q6J("ngModel",e.Details),t.xp6(6),t.Oqu(i.TKey.COMMON.NOTES),t.xp6(1),t.Q6J("ngModel",e.Notes),t.xp6(6),t.Oqu(i.TKey.COMMON.STATUS),t.xp6(1),t.Q6J("ngModel",e.Status),t.xp6(1),t.Q6J("ngForOf",i.tasksStatus),t.xp6(1),t.Q6J("ngIf",e.ID),t.xp6(1),t.Q6J("ngIf",e.ID)}}function Gt(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"de-confirmation-dialog",75),t.NdJ("onSuccess",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.deleteRecord())})("onCancel",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.recordToDelete=null)}),t.qZA()}if(2&n){const e=t.oxw();t.Q6J("title","Delete Patrol?")("content","Are you sure you want to delete task '"+e.recordToDelete.Type+"'?")}}const Ht=function(){return["expandedDetail"]},Pt=function(){return[25,50,100,150]};class p extends k.H6{constructor(){super(...arguments),this.durationColName="Duration",this.data=new r.by([]),this.fullData=[],this.activeTaskStatus="Open",this.taskColumns=this.settingsService.metadata.sheetsInfo?.TASKS?.cols,this.detailViewInfo=["Reminders",this.taskColumns?.TYPE?.label||"",this.taskColumns?.PRIORITY?.label||"",this.taskColumns?.TITLE?.label||"",this.taskColumns?.ASSIGNEDTO?.label||"",this.taskColumns?.DETAILS?.label||"",this.taskColumns?.NOTES?.label||"",this.taskColumns?.OPENDATE?.label||"",this.taskColumns?.DONEDATE?.label||"","More Details"],this.allColumns=["UiPriority",this.taskColumns?.TYPE?.label||"",this.taskColumns?.TITLE?.label||"",this.durationColName,this.taskColumns?.ASSIGNEDTO?.label||""],this.displayedColumns=[],this.searchText="",this.searchTextRegexp=new RegExp(""),this.cacheInfo=null,this.tasksStatus=this.settingsService.metadata.taskStatus,this.loginUsers=this.settingsService.metadata.loginUsers?.filter(o=>!o.name.match(/(test|service)/i))}ngOnInit(){this.filterSearch=this.filterSearch.bind(this),this.filterTaskStatus=this.filterTaskStatus.bind(this),this._subscriptions.push(this.eventService.isMobile.subscribe(()=>this.refreshDisplayedColumns())),this.settingsService.pageTitle=this.TKey.COMMON.CABLE,this.authService.isTasksAdmin()||(this.tasksStatus=this.settingsService.metadata.taskStatus?.slice(0,this.settingsService.metadata.taskStatus.length-1),this.detailViewInfo.shift())}ngAfterViewInit(){this.data.sort=this.sort,this.data.paginator=this.paginator,this.refreshDisplayedColumns(),this.refreshData(!1,!0)}ngOnDestroy(){super.ngOnDestroy(),this.cacheInfo?.destroy()}refreshDisplayedColumns(){this.displayedColumns=this.authService.isTasksAdmin()&&!this.settingsService.isMobile?this.allColumns.slice(0,5):this.allColumns.slice(0,4),this.displayedColumns.push("ACTIONS")}hideEditDetailsDialog(){this.recordToEdit=null,this.recordToEditOrig=null}saveOrUpdateTask(){if(!this.recordToEdit)return;this.settingsService.processingText="Updating data...";const o=this.recordToEdit.clone();o.ID=o.ID||Date.now().toString(),o.OpenDate=o.getOpenCloseDate(o.OpenDate||Date.now()),o.AssignedTo=o.AssignedTo,this.recordToEditOrig?.Status!==o.Status&&"Done"===o.Status&&(o.DoneDate=o.getOpenCloseDate(Date.now())),this.apiGSheetDataService.saveOrUpdateRecord(this.settingsService.metadata.sheetsInfo?.TASKS?.label,[this.taskColumns?.ID?.label],o).subscribe({next:()=>{this.settingsService.processingText="",this.refreshData(!0)},error:e=>{this.settingsService.processingText="",this.utilService.openErrorSnackBar(e,"Close")}})}refreshData(o=!1,e=!1){this.settingsService.processingText="Refreshing data...",this.apiGSheetDataService.getSheetData(this.settingsService.metadata.sheetsInfo?.TASKS.label,C.Oo,o).pipe((0,D.b)(i=>this.getRefreshCacheInfo(`SHEET_${this.settingsService.metadata.sheetsInfo?.TASKS.label}`,this.cacheInfo).pipe((0,v.U)(a=>(this.cacheInfo=a,i))))).subscribe({next:i=>{this.settingsService.processingText="",this.fullData=this.authService.isTasksAdmin()?i:i.filter(a=>a.isAssignedTo(this.authService.Username)),this.initializeFilters(e)},error:()=>this.settingsService.processingText="",complete:()=>{this.recordToDelete=null,this.hideEditDetailsDialog()}})}initializeFilters(o=!1){this.onFilterChange()}onFilterChange(){this.immediateFilterChange()}filterSearch(o){return o.freeTextSearch(this.searchTextRegexp)}filterTaskStatus(o){return o.Status===this.activeTaskStatus}createRecord(){this.recordToEditOrig=null,this.recordToEdit=new C.Oo({Date:new Date,By:this.authService.Username,Status:"Open"})}editRecord(o){this.recordToEditOrig=o,this.recordToEdit=o.clone()}deleteRecord(){this.settingsService.processingText="Deleting record...",this.apiGSheetDataService.deleteRecord(this.settingsService.metadata.sheetsInfo?.TASKS?.label,[this.taskColumns?.ID?.label],this.recordToDelete).subscribe({next:()=>{this.settingsService.processingText="",this.refreshData(!0)},error:o=>{this.settingsService.processingText="",this.utilService.openErrorSnackBar(o,"Close")}})}getCellClassNames(o,e){return""}toggleExpandedRow(o){this.expandedElement=this.expandedElement===o?null:o}getAssignedUsersInfo(o){return o.getAssignedUsersList().map(e=>({name:e,mobile:this.settingsService.getUserMobileNumber(e)}))}sendTaskReminder(o,e,i=!1){var a=this;return(0,N.Z)(function*(){yield a.utilService.copyToClipboard(o.getReminderText(i)),window.open(e?"https://chat.whatsapp.com/JH13RCt5pu8JkmFkiQgDif":"https://chat.whatsapp.com/GvB66u4eL3THScCIsuK9NY","_blank")})()}selectedTabChange(o){switch(o.index){case 0:default:this.activeTaskStatus="Open";break;case 1:this.activeTaskStatus="Done";break;case 2:this.activeTaskStatus="Verified"}this.immediateFilterChange()}immediateFilterChange(){let e=this.filterSearch,i=this.filterTaskStatus;this.searchText?this.searchTextRegexp=this.utilService.getFlexibleSearchTextRegexp(this.searchText):e=a=>!0,this.data.data=this.fullData.filter(e).filter(i)}static#t=this.\u0275fac=function(){let o;return function(i){return(o||(o=t.n5z(p)))(i||p)}}();static#e=this.\u0275cmp=t.Xpm({type:p,selectors:[["de-tasks-list"]],viewQuery:function(e,i){if(1&e&&(t.Gf(g.YE,5),t.Gf(h.NW,5)),2&e){let a;t.iGM(a=t.CRH())&&(i.sort=a.first),t.iGM(a=t.CRH())&&(i.paginator=a.first)}},features:[t.qOj],decls:23,vars:15,consts:[["mat-stretch-tabs","true","mat-align-tabs","center",3,"selectedTabChange"],["labelClass","de-p-hsmall--force"],["mat-tab-label",""],[4,"ngIf"],[1,"de-f-aligncenter","de-f-justifyright","de-m-vbase","de-sm-rbase-nolast"],["mat-raised-button","","color","accent",3,"click",4,"ngIf"],[3,"cacheInfo","refreshTriggerInterval","refresh"],["matSort","","matSortActive","UiPriority","matSortDirection","asc","multiTemplateDataRows","",1,"mat-elevation-z8",3,"dataSource"],[3,"matColumnDef",4,"ngFor","ngForOf"],["matColumnDef","expandedDetail"],["class","expanded-detail-cell",3,"ngClass",4,"matCellDef"],[4,"matHeaderRowDef","matHeaderRowDefSticky"],[3,"ngClass","click",4,"matRowDef","matRowDefColumns"],["mat-row","","class","expanded-detail-row",4,"matRowDef","matRowDefColumns"],["pageSize","50","showFirstLastButtons","",3,"pageSizeOptions"],["classNames","customer-card-dialog",3,"closeDialog",4,"ngIf"],["taskDetailViewReadOnly",""],["taskDetailView",""],[3,"title","content","onSuccess","onCancel",4,"ngIf"],[1,"de-m-rbase"],["mat-raised-button","","color","accent",3,"click"],[3,"matColumnDef"],["mat-sort-header","",3,"ngClass",4,"matHeaderCellDef"],[3,"ngClass",4,"matCellDef"],["mat-sort-header","",3,"ngClass"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"ngClass"],[1,"success-text"],[1,"danger-text"],[1,"primary-text"],["class","mobile-cell de-sm-rsmall-nolast",4,"ngIf"],[1,"mobile-cell","de-sm-rsmall-nolast"],[3,"text"],[1,"de-f-aligncenter","de-sm-rbase-nolast"],["displayType","CALL",3,"mobile"],["displayType","WHATSAPP",3,"mobile"],["color","primary",1,"de-cursorpointer","de-m-rbase",3,"click"],["color","warn","class","de-cursorpointer",3,"click",4,"ngIf"],["color","warn",1,"de-cursorpointer",3,"click"],[1,"expanded-detail-cell",3,"ngClass"],["class","de-p-bmedium de-p-tbase de-w-full",4,"ngIf"],[1,"de-p-bmedium","de-p-tbase","de-w-full"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"ngClass","click"],["mat-row","",1,"expanded-detail-row"],["classNames","customer-card-dialog",3,"closeDialog"],["de-dialog-header",""],["de-dialog-body",""],["de-dialog-footer",""],["mat-raised-button","","color","warn",3,"click"],[1,"de-f-aligncenter","de-sm-rsmall-nolast"],["mat-raised-button","","color","primary",3,"click"],[1,"de-w-full","details-table"],[4,"ngFor","ngForOf"],["class","reminders-cell de-f-aligncenter de-sm-rsmall-nolast de-sm-vsmall de-f-wrap",4,"ngSwitchCase"],["class","bold-text",3,"ngClass",4,"ngSwitchCase"],[1,"reminders-cell","de-f-aligncenter","de-sm-rsmall-nolast","de-sm-vsmall","de-f-wrap"],["mat-raised-button","",3,"click"],["svgIcon","whatsappreminder",1,"reminder-icon"],[1,"bold-text",3,"ngClass"],["class","de-f-aligncenter de-sm-rsmall-nolast",4,"ngFor","ngForOf"],["class","de-f-aligncenter",4,"ngFor","ngForOf"],[1,"de-f-aligncenter"],["target","_blank",1,"de-if-aligncenter",3,"href"],[3,"text","displayText"],[3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["multiple","",3,"ngModel","ngModelChange"],["matInput","","type","text",3,"ngModel","ngModelChange"],["matSuffix","","mat-icon-button","",3,"click"],["class","readonly",4,"ngIf"],[3,"value"],[1,"readonly"],[3,"title","content","onSuccess","onCancel"]],template:function(e,i){1&e&&(t.TgZ(0,"mat-tab-group",0),t.NdJ("selectedTabChange",function(c){return i.selectedTabChange(c)}),t.TgZ(1,"mat-tab",1),t.YNc(2,$,3,0,"ng-template",2),t.qZA(),t.TgZ(3,"mat-tab"),t.YNc(4,F,3,0,"ng-template",2),t.qZA(),t.YNc(5,R,2,0,"mat-tab",3),t.qZA(),t.TgZ(6,"div",4),t.YNc(7,B,4,1,"button",5),t.TgZ(8,"de-refresh-data",6),t.NdJ("refresh",function(){return i.refreshData(!0)}),t.qZA()(),t.TgZ(9,"mat-table",7),t.YNc(10,ut,3,1,"ng-container",8),t.ynx(11,9),t.YNc(12,xt,2,3,"mat-cell",10),t.BQk(),t.YNc(13,ht,1,0,"mat-header-row",11),t.YNc(14,kt,1,3,"mat-row",12),t.YNc(15,St,1,0,"mat-row",13),t.qZA(),t._UZ(16,"mat-paginator",14),t.YNc(17,bt,19,8,"de-dialog",15),t.YNc(18,qt,2,1,"ng-template",null,16,t.W1O),t.YNc(20,Bt,40,35,"ng-template",null,17,t.W1O),t.YNc(22,Gt,1,2,"de-confirmation-dialog",18)),2&e&&(t.xp6(5),t.Q6J("ngIf",i.authService.isTasksAdmin()),t.xp6(2),t.Q6J("ngIf",i.settingsService.isOnline&&"Open"===i.activeTaskStatus),t.xp6(1),t.Q6J("cacheInfo",i.cacheInfo)("refreshTriggerInterval",60),t.xp6(1),t.Q6J("dataSource",i.data),t.xp6(1),t.Q6J("ngForOf",i.displayedColumns),t.xp6(3),t.Q6J("matHeaderRowDef",i.displayedColumns)("matHeaderRowDefSticky",!0),t.xp6(1),t.Q6J("matRowDefColumns",i.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",t.DdM(13,Ht)),t.xp6(1),t.Q6J("pageSizeOptions",t.DdM(14,Pt)),t.xp6(1),t.Q6J("ngIf",i.recordToEdit),t.xp6(5),t.Q6J("ngIf",i.recordToDelete))},dependencies:[y.z,Q.$,J.a,L.D,U.s,m.mk,m.sg,m.O5,m.tP,m.RF,m.n9,m.ED,u.Fj,u.JJ,u.On,I.ey,S.lW,S.RK,T.KE,T.hX,T.R9,q.Hw,E.Nt,g.YE,g.nU,h.NW,Y.gD,r.BZ,r.fO,r.as,r.w1,r.Dz,r.nj,r.ge,r.ev,r.XQ,r.Gk,f.uD,f.uX,f.SP],styles:["[_nghost-%COMP%]{display:block;padding:12px;height:100%;width:100%}",'mat-header-cell[_ngcontent-%COMP%]:first-child:not([colspan="10"]), mat-cell[_ngcontent-%COMP%]:first-child:not([colspan="10"]), mat-header-cell[_ngcontent-%COMP%]:nth-child(2), mat-cell[_ngcontent-%COMP%]:nth-child(2){align-items:center;justify-content:center;padding:0!important;max-width:36px!important;width:36px!important}mat-header-cell[_ngcontent-%COMP%]:first-child:not([colspan="10"]), mat-cell[_ngcontent-%COMP%]:first-child:not([colspan="10"]){padding-left:12px!important}.highlight-row[_ngcontent-%COMP%]{background-color:#f0f0f0}.expanded-detail-row[_ngcontent-%COMP%]{min-height:0px}table[_ngcontent-%COMP%]{line-height:24px}.details-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{max-width:120px;min-width:90px}.reminders-cell[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:0 12px}mat-icon.reminder-icon[_ngcontent-%COMP%]{font-size:36px;height:36px;width:36px}'],data:{animation:[(0,_.X$)("detailExpand",[(0,_.SB)("collapsed",(0,_.oB)({height:"0px",minHeight:"0"})),(0,_.SB)("expanded",(0,_.oB)({height:"*"})),(0,_.eR)("expanded <=> collapsed",(0,_.jt)("225ms cubic-bezier(0.4, 0.0, 0.2, 1)"))])]}})}(0,A.gn)([(0,M.Ds)(500)],p.prototype,"onFilterChange",null);var w=s(1896);const Vt=[{path:"list",component:p},{path:"**",redirectTo:"list"}];let b=(()=>{class n{static#t=this.\u0275fac=function(i){return new(i||n)};static#e=this.\u0275mod=t.oAB({type:n});static#n=this.\u0275inj=t.cJS({imports:[w.Bz.forChild(Vt),w.Bz]})}return n})();s(8313);let zt=(()=>{class n{static#t=this.\u0275fac=function(i){return new(i||n)};static#e=this.\u0275mod=t.oAB({type:n});static#n=this.\u0275inj=t.cJS({imports:[k.nC.forChild(),b]})}return n})()}}]);