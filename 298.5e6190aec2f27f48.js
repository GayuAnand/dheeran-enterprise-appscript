"use strict";(self.webpackChunkcap_webview=self.webpackChunkcap_webview||[]).push([[298],{8298:(G,g,i)=>{i.r(g),i.d(g,{TasksListComponent:()=>r,TasksModule:()=>z,TasksRoutingModule:()=>C});var _=i(7582),p=i(3365),s=i(5313),c=i(6825),x=i(7848),u=i(2300),O=i(6328),T=i(7398),b=i(298),t=i(5879),M=i(2099),P=i(9653),w=i(3969),m=i(6814),S=i(617),h=i(3566),d=i(4104);function v(e,a){1&e&&(t.TgZ(0,"mat-icon",12),t._uU(1,"checklist"),t.qZA(),t._uU(2," Open "))}function y(e,a){1&e&&(t.TgZ(0,"mat-icon",12),t._uU(1,"done"),t.qZA(),t._uU(2," Done "))}function D(e,a){1&e&&(t.TgZ(0,"mat-icon",12),t._uU(1,"check_circle"),t.qZA(),t._uU(2," Verified "))}function k(e,a){1&e&&(t.TgZ(0,"mat-tab"),t.YNc(1,D,3,0,"ng-template",1),t._uU(2," Content 3 "),t.qZA())}function Z(e,a){if(1&e&&(t.TgZ(0,"mat-header-cell",16),t._uU(1),t.qZA()),2&e){const o=t.oxw().$implicit;t.Q6J("ngClass","de-f-justifycenter"),t.xp6(1),t.Oqu("ACTIONS"===o?"":o)}}function A(e,a){if(1&e&&(t.TgZ(0,"div",22),t._UZ(1,"de-copyable-text",23),t.TgZ(2,"div",24),t._UZ(3,"de-mobile-number",25)(4,"de-mobile-number",26),t.qZA()()),2&e){const o=t.oxw(2).$implicit,n=t.oxw().$implicit;t.xp6(1),t.Q6J("text",o[n]),t.xp6(2),t.Q6J("mobile",o[n]),t.xp6(1),t.Q6J("mobile",o[n])}}function I(e,a){if(1&e&&(t.ynx(0),t.YNc(1,A,5,3,"div",21),t.BQk()),2&e){const o=t.oxw().$implicit,n=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",o[n])}}function N(e,a){if(1&e&&(t.ynx(0),t._uU(1),t.BQk()),2&e){const o=t.oxw().$implicit,n=t.oxw().$implicit;t.xp6(1),t.Oqu(o[n])}}function R(e,a){if(1&e&&(t.TgZ(0,"mat-cell",17),t.ynx(1,18),t.YNc(2,I,2,1,"ng-container",19),t.YNc(3,N,2,1,"ng-container",20),t.BQk(),t.qZA()),2&e){const o=a.$implicit,n=t.oxw().$implicit,l=t.oxw();t.Q6J("ngClass",l.getCellClassNames(o,n)),t.xp6(1),t.Q6J("ngSwitch",n),t.xp6(1),t.Q6J("ngSwitchCase","MOBILE")}}function Q(e,a){1&e&&(t.ynx(0,13),t.YNc(1,Z,2,2,"mat-header-cell",14),t.YNc(2,R,4,3,"mat-cell",15),t.BQk()),2&e&&t.s9C("matColumnDef",a.$implicit)}function L(e,a){1&e&&(t.TgZ(0,"div",29),t._uU(1," DETAIL VIEW "),t.qZA())}function E(e,a){if(1&e&&(t.TgZ(0,"mat-cell",27),t.YNc(1,L,2,0,"div",28),t.qZA()),2&e){const o=a.$implicit,n=t.oxw();t.Q6J("ngClass",o!==n.expandedElement?"de-noborder--force":""),t.uIk("colspan",n.displayedColumns.length),t.xp6(1),t.Q6J("ngIf",o===n.expandedElement)}}function J(e,a){1&e&&t._UZ(0,"mat-header-row")}function U(e,a){if(1&e){const o=t.EpF();t.TgZ(0,"mat-row",30),t.NdJ("click",function(){const H=t.CHM(o).$implicit,j=t.oxw();return t.KtG(j.toggleExpandedRow(H))}),t.qZA()}if(2&e){const o=a.$implicit,n=t.oxw();t.Q6J("ngClass",n.expandedElement===o?"highlight-row":"")}}function B(e,a){1&e&&t._UZ(0,"mat-row",31)}const F=function(){return["expandedDetail"]},Y=function(){return[25,50,100,20]};class r extends u.H6{constructor(){super(...arguments),this.data=new s.by([]),this.fullData=[],this.taskColumns=this.settingsService.metadata.sheetsInfo?.TASKS?.cols,this.allColumns=[this.taskColumns?.ID?.label||"",this.taskColumns?.PRIORITY?.label||"",this.taskColumns?.OPENDATE?.label||"",this.taskColumns?.ASSIGNEDTO?.label||""],this.displayedColumns=[],this.searchText="",this.searchTextRegexp=new RegExp(""),this.cacheInfo=null}ngOnInit(){this.filterSearch=this.filterSearch.bind(this),this._subscriptions.push(this.eventService.isMobile.subscribe(()=>this.refreshDisplayedColumns())),this.settingsService.pageTitle=this.TKey.COMMON.CABLE,this.geolocationService.getCurrentPosition().subscribe(a=>console.log(a))}ngAfterViewInit(){this.data.paginator=this.paginator,this.refreshDisplayedColumns(),this.refreshData(!1,!0)}ngOnDestroy(){super.ngOnDestroy(),this.cacheInfo?.destroy()}refreshDisplayedColumns(){this.displayedColumns=this.authService.isTasksAdmin()?this.allColumns.slice(0,4):this.allColumns.slice(0,3),this.displayedColumns.push("ACTIONS")}refreshData(a=!1,o=!1){this.settingsService.processingText="Refreshing data...",this.apiGSheetDataService.getSheetData(this.settingsService.metadata.sheetsInfo?.TASKS.label,x.Oo,a).pipe((0,O.b)(n=>this.getRefreshCacheInfo(`SHEET_${this.settingsService.metadata.sheetsInfo?.TASKS.label}`,this.cacheInfo).pipe((0,T.U)(l=>(this.cacheInfo=l,n))))).subscribe({next:n=>{this.settingsService.processingText="",this.fullData=n,this.initializeFilters(o)},error:()=>this.settingsService.processingText=""})}initializeFilters(a=!1){}onFilterChange(){let o=this.filterSearch;this.searchText?this.searchTextRegexp=this.utilService.getFlexibleSearchTextRegexp(this.searchText):o=n=>!0,this.data.data=this.fullData.filter(o)}filterSearch(a){return a.freeTextSearch(this.searchTextRegexp)}getCellClassNames(a,o){return""}toggleExpandedRow(a){this.expandedElement=this.expandedElement===a?null:a}static#t=this.\u0275fac=function(){let a;return function(n){return(a||(a=t.n5z(r)))(n||r)}}();static#e=this.\u0275cmp=t.Xpm({type:r,selectors:[["de-tasks-list"]],viewQuery:function(o,n){if(1&o&&t.Gf(p.NW,5),2&o){let l;t.iGM(l=t.CRH())&&(n.paginator=l.first)}},features:[t.qOj],decls:17,vars:12,consts:[["mat-stretch-tabs","true","mat-align-tabs","center"],["mat-tab-label",""],[4,"ngIf"],[3,"cacheInfo","refreshTriggerInterval","refresh"],["matSort","","matSortActive","CUSTOMER_NAME","matSortDirection","asc","multiTemplateDataRows","",1,"mat-elevation-z8",3,"dataSource"],[3,"matColumnDef",4,"ngFor","ngForOf"],["matColumnDef","expandedDetail"],["class","expanded-detail-cell",3,"ngClass",4,"matCellDef"],[4,"matHeaderRowDef","matHeaderRowDefSticky"],[3,"ngClass","click",4,"matRowDef","matRowDefColumns"],["mat-row","","class","expanded-detail-row",4,"matRowDef","matRowDefColumns"],["pageSize","50","showFirstLastButtons","",3,"pageSizeOptions"],[1,"de-m-rbase"],[3,"matColumnDef"],["mat-sort-header","",3,"ngClass",4,"matHeaderCellDef"],[3,"ngClass",4,"matCellDef"],["mat-sort-header","",3,"ngClass"],[3,"ngClass"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["class","mobile-cell de-sm-rsmall-nolast",4,"ngIf"],[1,"mobile-cell","de-sm-rsmall-nolast"],[3,"text"],[1,"de-f-aligncenter","de-sm-rbase-nolast"],["displayType","CALL",3,"mobile"],["displayType","WHATSAPP",3,"mobile"],[1,"expanded-detail-cell",3,"ngClass"],["class","de-p-bmedium de-p-tbase de-w-full",4,"ngIf"],[1,"de-p-bmedium","de-p-tbase","de-w-full"],[3,"ngClass","click"],["mat-row","",1,"expanded-detail-row"]],template:function(o,n){1&o&&(t.TgZ(0,"mat-tab-group",0)(1,"mat-tab"),t.YNc(2,v,3,0,"ng-template",1),t._uU(3," Content 1 "),t.qZA(),t.TgZ(4,"mat-tab"),t.YNc(5,y,3,0,"ng-template",1),t._uU(6," Content 2 "),t.qZA(),t.YNc(7,k,3,0,"mat-tab",2),t.qZA(),t.TgZ(8,"de-refresh-data",3),t.NdJ("refresh",function(){return n.refreshData(!0)}),t.qZA(),t.TgZ(9,"mat-table",4),t.YNc(10,Q,3,1,"ng-container",5),t.ynx(11,6),t.YNc(12,E,2,3,"mat-cell",7),t.BQk(),t.YNc(13,J,1,0,"mat-header-row",8),t.YNc(14,U,1,1,"mat-row",9),t.YNc(15,B,1,0,"mat-row",10),t.qZA(),t._UZ(16,"mat-paginator",11)),2&o&&(t.xp6(7),t.Q6J("ngIf",n.authService.isTasksAdmin()),t.xp6(1),t.Q6J("cacheInfo",n.cacheInfo)("refreshTriggerInterval",4320),t.xp6(1),t.Q6J("dataSource",n.data),t.xp6(1),t.Q6J("ngForOf",n.displayedColumns),t.xp6(3),t.Q6J("matHeaderRowDef",n.displayedColumns)("matHeaderRowDefSticky",!0),t.xp6(1),t.Q6J("matRowDefColumns",n.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",t.DdM(10,F)),t.xp6(1),t.Q6J("pageSizeOptions",t.DdM(11,Y)))},dependencies:[M.$,P.D,w.s,m.mk,m.sg,m.O5,m.RF,m.n9,m.ED,S.Hw,h.YE,h.nU,p.NW,s.BZ,s.fO,s.as,s.w1,s.Dz,s.nj,s.ge,s.ev,s.XQ,s.Gk,d.uD,d.uX,d.SP],styles:["[_nghost-%COMP%]{display:block;padding:12px;height:100%;width:100%}",".filter-row[_ngcontent-%COMP%]   .advanced-filter-label[_ngcontent-%COMP%]{color:var(--primary);justify-content:end;margin-top:6px;margin-bottom:6px;text-decoration:underline;width:100%}mat-table[_ngcontent-%COMP%]     mat-header-row mat-header-cell:not([colspan]):last-child, mat-table[_ngcontent-%COMP%]     mat-row mat-cell:not([colspan]):last-child{max-width:90px;min-width:90px}.highlight-row[_ngcontent-%COMP%]{background-color:#f0f0f0}.select-all[_ngcontent-%COMP%]{padding:6px}.expanded-detail-row[_ngcontent-%COMP%], .expanded-detail-cell[_ngcontent-%COMP%]{min-height:0px}.collection-filter[_ngcontent-%COMP%], .pending-settlement-filter[_ngcontent-%COMP%], .location-container[_ngcontent-%COMP%]{align-items:flex-start;border:1px solid rgba(0,0,0,.38);border-radius:4px;flex-direction:column;padding:20px;position:relative}.collection-filter[_ngcontent-%COMP%] > label[_ngcontent-%COMP%], .pending-settlement-filter[_ngcontent-%COMP%] > label[_ngcontent-%COMP%], .location-container[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{background:#fafafa;color:#0009;font-size:12px;left:12px;padding:0 6px;position:absolute;top:-11px}.collection-filter[_ngcontent-%COMP%] > mat-slide-toggle[_ngcontent-%COMP%], .pending-settlement-filter[_ngcontent-%COMP%] > mat-slide-toggle[_ngcontent-%COMP%], .location-container[_ngcontent-%COMP%] > mat-slide-toggle[_ngcontent-%COMP%]{margin-bottom:16px}.collection-filter[_ngcontent-%COMP%] > mat-form-field[_ngcontent-%COMP%], .pending-settlement-filter[_ngcontent-%COMP%] > mat-form-field[_ngcontent-%COMP%], .location-container[_ngcontent-%COMP%] > mat-form-field[_ngcontent-%COMP%]{width:100%}.location-container[_ngcontent-%COMP%]{padding-bottom:0}.mobile-cell[_ngcontent-%COMP%]{align-items:center;display:flex;flex-wrap:wrap;justify-content:center}.customer-details[_ngcontent-%COMP%]{width:100%}.customer-details[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{max-width:150px}table.customer-card[_ngcontent-%COMP%]{border-collapse:collapse;border-color:#dee2e6;display:table;margin-bottom:24px;max-width:400px;text-align:center;width:100%}table.customer-card[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#d2d8ff;font-weight:500}table.customer-card[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], table.customer-card[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:1px solid rgb(222,226,230);border-collapse:collapse;padding:6px}table.customer-card.full-width[_ngcontent-%COMP%], table.customer-details.full-width[_ngcontent-%COMP%]{min-width:100%}table.customer-card[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child, table.customer-details[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child{text-align:left}table.customer-card[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:not([matinput]), table.customer-details[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:not([matinput]){border:0px;outline:none;width:50px}table.customer-card[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:not([matinput]):focus, table.customer-details[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:not([matinput]):focus{outline:none}table.customer-card[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:not([matinput]).notes, table.customer-details[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:not([matinput]).notes{width:200px}table.customer-card[_ngcontent-%COMP%]   input.mat-datepicker-input[_ngcontent-%COMP%], table.customer-details[_ngcontent-%COMP%]   input.mat-datepicker-input[_ngcontent-%COMP%]{width:auto}table.customer-card[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], table.customer-details[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{border-color:#cacaca;border-radius:4px}  .customer-card-dialog{max-width:600px!important}"],data:{animation:[(0,c.X$)("detailExpand",[(0,c.SB)("collapsed",(0,c.oB)({height:"0px",minHeight:"0"})),(0,c.SB)("expanded",(0,c.oB)({height:"*"})),(0,c.eR)("expanded <=> collapsed",(0,c.jt)("225ms cubic-bezier(0.4, 0.0, 0.2, 1)"))])]}})}(0,_.gn)([(0,b.Ds)(500)],r.prototype,"onFilterChange",null);var f=i(1896);const $=[{path:"list",component:r},{path:"**",redirectTo:"list"}];let C=(()=>{class e{static#t=this.\u0275fac=function(n){return new(n||e)};static#e=this.\u0275mod=t.oAB({type:e});static#n=this.\u0275inj=t.cJS({imports:[f.Bz.forChild($),f.Bz]})}return e})();i(7161);let z=(()=>{class e{static#t=this.\u0275fac=function(n){return new(n||e)};static#e=this.\u0275mod=t.oAB({type:e});static#n=this.\u0275inj=t.cJS({imports:[u.nC.forChild(),C]})}return e})()}}]);